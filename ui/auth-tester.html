<script>
  async function testRoute() {
    const override = document.getElementById("override").value;
    const key = document.getElementById("key").value;
    const route = document.getElementById("route").value;
    const box = document.getElementById("resultBox");

    if (!route.startsWith("/")) {
      box.textContent = "Error: Route must start with '/'";
      return;
    }

    try {
      const res = await fetch(route, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-ob-override": override,
          "x-brobot-key": key
        },
        body: JSON.stringify({ query: "Test call from Auth UI" })
      });

      const data = await res.json();
      box.textContent = JSON.stringify(data, null, 2);
    } catch (e) {
      box.textContent = "Error: " + e.message;
    }
  }
</script>
